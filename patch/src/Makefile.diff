--- Makefile.orig	2021-08-29 12:00:21.437000000 +1000
+++ Makefile	2021-08-29 12:48:01.011917123 +1000
@@ -30,6 +30,10 @@
 
 include $(topdir)/Makefile.inc
 
+ifeq ($(LIBEXT), .so)
+	FPIC=-fPIC
+endif
+
 $(incdir)/mumps_int_def.h: build_mumps_int_def 
 	./build_mumps_int_def > $(incdir)/mumps_int_def.h
 build_mumps_int_def:build_mumps_int_def.o
@@ -193,12 +197,20 @@
         $(ARITH)type3_root.o
 
 $(libdir)/libmumps_common$(PLAT)$(LIBEXT):      $(OBJS_COMMON_MOD) $(OBJS_COMMON_OTHER)
+ifeq ($(LIBEXT), .so)
+	$(FC) $(OPTL) -shared $^ -Wl,-soname,libmumps_common$(PLAT).so -L$(libdir) $(LORDERINGS) -lpthread $(MPIFLIB) $(MPICLIB) -o $(libdir)/libmumps_common$(PLAT).so -Wl,-z,defs
+else
 	$(AR)$@ $?
 	$(RANLIB) $@
+endif
 
 $(libdir)/lib$(ARITH)mumps$(PLAT)$(LIBEXT):    $(OBJS_MOD) $(OBJS_OTHER)
+ifeq ($(LIBEXT), .so)
+	$(FC) $(OPTL) -shared $^ -Wl,-soname,lib$(ARITH)mumps$(PLAT).so -L$(libdir) -lmumps_common$(PLAT) $(LORDERINGS) $(MPIFLIB) $(LIBBLAS) $(SCALAP) $(LAPACK) -o $(libdir)/lib$(ARITH)mumps$(PLAT).so -Wl,-z,defs
+else
 	$(AR)$@ $?
 	$(RANLIB) $@
+endif
 
 # Dependencies between modules:
 # i) arithmetic-dependent modules:
@@ -411,13 +423,13 @@
 
 .SUFFIXES: .c .F .o
 .F.o:
-	$(FC) $(OPTF) -I. -I../include $(INCS) $(IORDERINGSF) $(ORDERINGSF) -c $*.F $(OUTF)$*.o
+	$(FC) $(OPTF) -I. -I../include $(INCS) $(IORDERINGSF) $(ORDERINGSF) $(FPIC) -c $*.F $(OUTF)$*.o
 .c.o:
-	$(CC) $(OPTC) -I../include $(INCS) $(CDEFS) $(IORDERINGSC) $(ORDERINGSC) -c $*.c $(OUTC)$*.o
+	$(CC) $(OPTC) -I../include $(INCS) $(CDEFS) $(IORDERINGSC) $(ORDERINGSC) $(FPIC) -c $*.c $(OUTC)$*.o
 
 $(ARITH)mumps_c.o:	mumps_c.c
 	$(CC) $(OPTC) -I../include $(INCS) $(CDEFS) -DMUMPS_ARITH=MUMPS_ARITH_$(ARITH) \
-	      $(IORDERINGSC) $(ORDERINGSC) -c mumps_c.c $(OUTC)$@
+	      $(IORDERINGSC) $(ORDERINGSC) $(FPIC) -c mumps_c.c $(OUTC)$@
 
 clean:
 	$(RM) *.o *.mod $(incdir)/mumps_int_def.h build_mumps_int_def
